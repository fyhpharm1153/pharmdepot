<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114Q4 è—¥å“é€²åº¦è¿½è¹¤</title>
    <style>
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: #f0f2f5; padding: 20px; color: #333; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h2 { text-align: center; color: #1a73e8; margin-bottom: 25px; border-bottom: 2px solid #e8f0fe; padding-bottom: 10px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; table-layout: fixed; }
        th { background-color: #f8f9fa; color: #5f6368; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #eee; word-wrap: break-word; }
        
        tr:hover { background-color: #fdfdfd; }
        
        .badge { padding: 6px 12px; border-radius: 20px; font-size: 13px; font-weight: bold; display: inline-block; }
        .bg-success { background-color: #e6f4ea; color: #1e7e34; } /* å®Œæˆ/é–‹æª” */
        .bg-warning { background-color: #fef7e0; color: #b05a00; } /* é€²è¡Œä¸­ */
        .bg-danger { background-color: #fce8e6; color: #d93025; }  /* é—œæª”/åœæ»¯ */
        .bg-default { background-color: #f1f3f4; color: #70757a; } 

        .loading { text-align: center; padding: 50px; font-size: 18px; color: #1a73e8; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“‹ 114Q4 è—¥å“æ¡è³¼èˆ‡å»ºæª”é€²åº¦çœ‹æ¿</h2>
    <div id="status-container">
        <div id="loading" class="loading">ğŸ“¡ æ­£åœ¨åŒæ­¥ Google Sheets è³‡æ–™...</div>
        <table id="data-table" style="display:none;">
            <thead>
                <tr>
                    <th style="width: 40%;">è—¥å“åç¨± (H)</th>
                    <th>æ¡è³¼é€²åº¦ (S)</th>
                    <th>HIS å»ºæª” (T)</th>
                    <th>é–‹/é—œæª” (U)</th>
                </tr>
            </thead>
            <tbody id="table-body"></tbody>
        </table>
    </div>
</div>

<script>
    // æŒ‡å‘ç‰¹å®šåˆ†é ä¸¦è¼¸å‡ºç‚º CSV
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQVAyi3_RHMvbMH91EKHlNIMF6cMvgPjw-29OczSJnJjyNT6FeOAusRSPTn7UH17I8VJUD9cBydhcJr/pub?output=csv&gid=283594106";

    async function fetchData() {
        try {
            const response = await fetch(csvUrl);
            const csvText = await response.text();
            
            // ä½¿ç”¨ç°¡å–®æ­£å‰‡è™•ç† CSVï¼Œé¿å…å…§å®¹ä¸­æœ‰é€—è™Ÿå°è‡´éŒ¯ä½
            const rows = csvText.split('\n').map(row => {
                // é€™æ˜¯ä¸€å€‹ç°¡å–®çš„è™•ç†æ–¹å¼ï¼Œè‹¥è³‡æ–™å…§æœ‰ç‰¹æ®Šé€—è™Ÿå¯èƒ½éœ€æ›´è¤‡é›œçš„ Parser
                return row.split(',');
            });
            
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = ''; 

            // å¾ç¬¬ 2 åˆ—æˆ–ç¬¬ 3 åˆ—é–‹å§‹ï¼ˆè¦–ä½ çš„æ¨™é¡Œåˆ—é•·åº¦è€Œå®šï¼Œé€™è£¡è¨­ 1 ç‚ºç•¥éç¬¬ä¸€è¡Œæ¨™é¡Œï¼‰
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                if (!row[7]) continue; // å¦‚æœ H æ¬„ (è—¥å“åç¨±) æ˜¯ç©ºçš„å°±è·³é

                const name = row[7].trim();     // H æ¬„
                const progress = row[18] ? row[18].trim() : '---'; // S æ¬„
                const his = row[19] ? row[19].trim() : '---';      // T æ¬„
                const status = row[20] ? row[20].trim() : '---';   // U æ¬„

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${name}</strong></td>
                    <td>${renderBadge(progress)}</td>
                    <td>${renderBadge(his)}</td>
                    <td>${renderBadge(status)}</td>
                `;
                tableBody.appendChild(tr);
            }

            document.getElementById('loading').style.display = 'none';
            document.getElementById('data-table').style.display = 'table';

        } catch (error) {
            document.getElementById('loading').innerHTML = "âŒ ç„¡æ³•è®€å–è³‡æ–™ï¼Œè«‹ç¢ºèª Google Sheet å·²ã€Œç™¼ä½ˆåˆ°ç¶²è·¯ã€ã€‚";
        }
    }

    function renderBadge(text) {
        if (!text || text === '---') return `<span class="badge bg-default">æœªæœ‰è³‡æ–™</span>`;
        
        let colorClass = "bg-default";
        if (text.includes("å®Œæˆ") || text.includes("å·²") || text.includes("é–‹æª”") || text.includes("OK")) {
            colorClass = "bg-success";
        } else if (text.includes("é€²") || text.includes("è¾¦ç†") || text.includes("å¾…")) {
            colorClass = "bg-warning";
        } else if (text.includes("é—œ") || text.includes("åœ") || text.includes("ä¸")) {
            colorClass = "bg-danger";
        }
        
        return `<span class="badge ${colorClass}">${text}</span>`;
    }

    fetchData();
</script>

</body>
</html>
