<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114Q4 è—¥å“é€²åº¦çœ‹æ¿</title>
    <style>
        :root { --base-font-size: 16px; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: #f0f2f5; padding: 20px; color: #333; font-size: var(--base-font-size); }
        .container { max-width: 1300px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        
        /* å·¥å…·åˆ—æ¨£å¼ */
        .toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        .btn { padding: 8px 16px; cursor: pointer; border: none; border-radius: 6px; font-weight: bold; transition: 0.2s; background: #e8f0fe; color: #1a73e8; }
        .btn:hover { background: #1a73e8; color: white; }
        .font-controls button { margin-left: 5px; width: 40px; }

        h2 { text-align: center; color: #1a73e8; width: 100%; margin-top: 0; }
        
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        th { background-color: #f8f9fa; color: #5f6368; font-weight: 600; padding: 12px; border-bottom: 2px solid #dee2e6; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; word-wrap: break-word; vertical-align: top; }
        
        /* ç‹€æ…‹æ¨™ç±¤åŸºç¤æ¨£å¼ */
        .badge { padding: 6px 12px; border-radius: 6px; font-size: 0.9em; font-weight: bold; display: inline-block; text-align: center; width: 90%; }
        
        /* 1. ç‹€æ…‹é…è‰²é‚è¼¯ */
        .status-ready { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; } /* ç¶ è‰²ï¼šå®Œæˆ/é–‹æª” */
        .status-work { background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; }  /* é»ƒè‰²ï¼šè¾¦ç†ä¸­/å¾…è¾¦ */
        .status-stop { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }  /* ç´…è‰²ï¼šé—œæª”/åœæ­¢ */
        .status-none { background-color: #f1f3f4; color: #70757a; border: 1px solid #dadce0; }  /* ç°è‰²ï¼šç„¡è³‡æ–™ */

        .loading { text-align: center; padding: 50px; font-size: 1.2em; color: #1a73e8; }
    </style>
</head>
<body>

<div class="container">
    <div class="toolbar">
        <button class="btn" onclick="history.back()">â† å›ä¸Šä¸€é </button>
        
        <h2>ğŸ’Š 114Q4 è—¥å“æ¡è³¼èˆ‡å»ºæª”çœ‹æ¿</h2>

        <div class="font-controls">
            <span>å­—é«”ï¼š</span>
            <button class="btn" onclick="changeFontSize(2)">A+</button>
            <button class="btn" onclick="changeFontSize(-2)">A-</button>
        </div>
    </div>

    <div id="loading" class="loading">ğŸ“¡ æ­£åœ¨åŒæ­¥è³‡æ–™ï¼Œè«‹ç¨å€™...</div>
    
    <table id="data-table" style="display:none;">
        <thead>
            <tr>
                <th style="width: 25%;">è—¥å“åç¨± (H)</th>
                <th style="width: 15%;">æ¡è³¼é€²åº¦ (S)</th>
                <th style="width: 15%;">HIS å»ºæª” (T)</th>
                <th style="width: 15%;">é–‹/é—œæª” (U)</th>
                <th style="width: 30%;">å‚™è¨» (L)</th>
            </tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>
</div>

<script>
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQVAyi3_RHMvbMH91EKHlNIMF6cMvgPjw-29OczSJnJjyNT6FeOAusRSPTn7UH17I8VJUD9cBydhcJr/pub?output=csv&gid=283594106";

    // å­—é«”ç¸®æ”¾åŠŸèƒ½
    let currentFontSize = 16;
    function changeFontSize(delta) {
        currentFontSize += delta;
        if (currentFontSize < 12) currentFontSize = 12;
        if (currentFontSize > 30) currentFontSize = 30;
        document.documentElement.style.setProperty('--base-font-size', currentFontSize + 'px');
    }

    // è‡ªå‹•åˆ¤æ–·é¡è‰²é¡åˆ¥
    function getStatusClass(text) {
        if (!text || text.trim() === "" || text.includes("---")) return "status-none";
        
        const t = text.trim();
        // ç¶ è‰²ï¼šå®Œæˆã€å·²ã€é–‹æª”
        if (t.includes("å®Œæˆ") || t.includes("å·²") || t.includes("é–‹æª”") || t.includes("OK")) return "status-ready";
        // ç´…è‰²ï¼šé—œæª”ã€åœã€ä¸ã€é€€
        if (t.includes("é—œæª”") || t.includes("åœ") || t.includes("ä¸") || t.includes("é€€")) return "status-stop";
        // é»ƒè‰²ï¼šå…¶é¤˜ï¼ˆé€²ä¸­ã€ç°½æ ¸ã€å¾…ã€è¾¦ç†ï¼‰
        return "status-work";
    }

    async function fetchData() {
        try {
            const response = await fetch(csvUrl);
            const csvText = await response.text();
            
            // ç°¡æ˜“ CSV è§£æï¼ˆè™•ç†æ›è¡Œï¼‰
            const rows = csvText.split('\n').map(row => row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/));
            const tableBody = document.getElementById('table-body');
            
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                if (!row[7] || row[7].trim() === "") continue; 

                const name = row[7].replace(/"/g, "").trim(); 
                const note = row[11] ? row[11].replace(/"/g, "").trim() : ""; 
                const s_val = (row[18] || "").replace(/"/g, "").trim();
                const t_val = (row[19] || "").replace(/"/g, "").trim();
                const u_val = (row[20] || "").replace(/"/g, "").trim();

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${name}</strong></td>
                    <td><span class="badge ${getStatusClass(s_val)}">${s_val || 'å¾…å®š'}</span></td>
                    <td><span class="badge ${getStatusClass(t_val)}">${t_val || 'å¾…å®š'}</span></td>
                    <td><span class="badge ${getStatusClass(u_val)}">${u_val || 'å¾…å®š'}</span></td>
                    <td style="color:#666; font-size:0.95em;">${note}</td>
                `;
                tableBody.appendChild(tr);
            }

            document.getElementById('loading').style.display = 'none';
            document.getElementById('data-table').style.display = 'table';
        } catch (e) {
            document.getElementById('loading').innerText = "âŒ è®€å–å¤±æ•—ï¼Œè«‹ç¢ºèªç¶²è·¯æˆ–è©¦ç®—è¡¨ç™¼ä½ˆè¨­å®šã€‚";
        }
    }

    fetchData();
</script>

</body>
</html>
