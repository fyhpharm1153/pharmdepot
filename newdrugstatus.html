<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è—¥å“æ¡è³¼èˆ‡å»ºæª”é€²åº¦è¿½è¹¤</title>
    <style>
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background-color: #f4f7f6; margin: 20px; }
        h2 { color: #2c3e50; text-align: center; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #34495e; color: white; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.9em; font-weight: bold; }
        /* ç°¡å–®çš„é¡è‰²å€åˆ† */
        .bg-success { background-color: #d4edda; color: #155724; } /* å·²å®Œæˆ / é–‹æª” */
        .bg-warning { background-color: #fff3cd; color: #856404; } /* é€²è¡Œä¸­ */
        .bg-danger { background-color: #f8d7da; color: #721c24; }  /* é—œæª” / åœæ»¯ */
        .loading { text-align: center; font-size: 1.2em; color: #666; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ’Š è—¥å“é€²åº¦è¿½è¹¤çœ‹æ¿</h2>
    <div id="loading" class="loading">æ­£åœ¨å¾ Google é›²ç«¯æŠ“å–æœ€æ–°è³‡æ–™...</div>
    <table id="data-table" style="display:none;">
        <thead>
            <tr>
                <th>è—¥å“åç¨±</th>
                <th>æ¡è³¼é€²åº¦</th>
                <th>HIS å»ºæª”</th>
                <th>é–‹/é—œæª”æƒ…å½¢</th>
            </tr>
        </thead>
        <tbody id="table-body">
            </tbody>
    </table>
</div>

<script>
    // æ‚¨çš„ Google Sheet CSV é€£çµ
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQVAyi3_RHMvbMH91EKHlNIMF6cMvgPjw-29OczSJnJjyNT6FeOAusRSPTn7UH17I8VJUD9cBydhcJr/pub?output=csv&gid=283594106";

    async function fetchData() {
        try {
            const response = await fetch(csvUrl);
            const csvText = await response.text();
            
            // è§£æ CSV (è™•ç†æ›è¡Œèˆ‡é€—è™Ÿ)
            const rows = csvText.split('\n').map(row => row.split(','));
            
            // å‡è¨­ï¼š
            // æ¨™é¡Œåˆ—é€šå¸¸åœ¨ç¬¬ä¸€åˆ—ï¼Œæˆ‘å€‘éœ€è¦æ ¹æ“šæ‚¨çš„è©¦ç®—è¡¨æ¬„ä½ç´¢å¼•ä¾†èª¿æ•´
            // é€™è£¡é è¨­ï¼šè—¥å“åç¨±åœ¨ç¬¬1æ¬„, æ¡è³¼é€²åº¦åœ¨ç¬¬2æ¬„, HISå»ºæª”åœ¨ç¬¬3æ¬„, é–‹é—œæª”åœ¨ç¬¬4æ¬„
            // å¦‚æœæ¬„ä½é †åºä¸åŒï¼Œè«‹ä¿®æ”¹ä¸‹æ–¹çš„ row[index]
            
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = ''; // æ¸…ç©º

            // å¾ç¬¬äºŒåˆ—é–‹å§‹æŠ“å–è³‡æ–™ (index 1)
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                if (row.length < 2) continue; // è·³éç©ºè¡Œ

                const name = row[1] || '---';      // è—¥å“åç¨±
                const progress = row[2] || '---';  // æ¡è³¼é€²åº¦
                const his = row[3] || '---';       // HISå»ºæª”
                const status = row[4] || '---';    // é–‹/é—œæª”

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${name}</strong></td>
                    <td><span class="status-badge ${getStatusClass(progress)}">${progress}</span></td>
                    <td><span class="status-badge ${getStatusClass(his)}">${his}</span></td>
                    <td><span class="status-badge ${getStatusClass(status)}">${status}</span></td>
                `;
                tableBody.appendChild(tr);
            }

            document.getElementById('loading').style.display = 'none';
            document.getElementById('data-table').style.display = 'table';

        } catch (error) {
            console.error("Error:", error);
            document.getElementById('loading').innerText = "è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ–é€£çµè¨­å®šã€‚";
        }
    }

    // æ ¹æ“šæ–‡å­—å…§å®¹è‡ªå‹•çµ¦é¡è‰²
    function getStatusClass(text) {
        if (text.includes("å®Œæˆ") || text.includes("é–‹æª”") || text.includes("å·²")) return "bg-success";
        if (text.includes("é€²ä¸­") || text.includes("è™•ç†")) return "bg-warning";
        if (text.includes("é—œæª”") || text.includes("æš«åœ") || text.includes("æœª")) return "bg-danger";
        return "";
    }

    fetchData();
</script>

</body>
</html>